import MdxImage from "next/image";

import ConnectWithNotion from "./connect-with-notion.png";
import DeleteConnection from "./delete-connection.png";
import IntegrationsTab from "./integrations-tab.png";
import LinkWithDatabases from "./link-with-databases.png";
import LinkWorkflowWithDatabase from "./link-workflow-with-database.png";
import ListLinkedDatabases from "./list-linked-databases.png";
import NotionConnected from "./notion-connected.png";

export const metadata = {
  title: "Notion",
  description:
    "The notion integration allows you to automatically send responses to a Notion database of your choice.",
};

#### Integrations

# Notion

The notion integration allows you to automatically send responses to a Notion database of your choice.

<Note>
  This feature is enabled by default in TypeflowAI Cloud but needs to be self-configured when running a
  self-hosted version of TypeflowAI.
</Note>

## TypeflowAI Cloud

1. Go to the Integrations tab in your [TypeflowAI Cloud dashboard](https://dashboard.typeflowai.com/) and click on the "Connect" button under Notion integration.

<MdxImage
  src={IntegrationsTab}
  alt="TypeflowAI Integrations Tab"
  quality="100"
  className="max-w-full rounded-lg sm:max-w-3xl"
/>

2. Now click on the "Connect with Notion" button to authenticate yourself with Notion.

<MdxImage
  src={ConnectWithNotion}
  alt="Connect TypeflowAI with your Notion account"
  quality="100"
  className="max-w-full rounded-lg sm:max-w-3xl"
/>

3. You will now be taken to the Notion OAuth page where you can select the Notion account you want to use for the integration

4. Once you have selected the account and databases and completed the authentication and authorization process, you will be taken back to TypeflowAI Cloud and see the connected status as below:

<MdxImage
  src={NotionConnected}
  alt="TypeflowAI is now connected with Notion"
  quality="100"
  className="max-w-full rounded-lg sm:max-w-3xl"
/>

<Note>
  Before the next step, make sure that you have a TypeflowAI Workflow with at least one question and a Notion
  database in the Notion account you integrated.
</Note>

5. Now click on the "Link New Database" button to link a new Notion database with TypeflowAI and a modal will open up.

<MdxImage
  src={LinkWithDatabases}
  alt="Link TypeflowAI with a Notion database"
  quality="100"
  className="max-w-full rounded-lg sm:max-w-3xl"
/>

6. Select the Notion database you want to link with TypeflowAI and the Workflow. On doing so, you will be asked to map typeflowai' workflow questions with selected databases' column. Complete the mapping and click on the "Link Database" button.

<MdxImage
  src={LinkWorkflowWithDatabase}
  alt="Question to notion database column mapping"
  quality="100"
  className="max-w-full rounded-lg sm:max-w-3xl"
/>

7. On submitting, the modal will close and you will see the linked Notion database in the list of linked Notion databases.

<MdxImage
  src={ListLinkedDatabases}
  alt="List of linked notion databases"
  quality="100"
  className="max-w-full rounded-lg sm:max-w-3xl"
/>

Congratulations! You have successfully linked a Notion database with TypeflowAI. Now whenever a response is submitted for the linked Workflow, it will be automatically added to the linked Notion database.

## Setup in self-hosted TypeflowAI

Enabling the Notion Integration in a self-hosted environment requires a setup using Notion account and changing the environment variables of your TypeflowAI instance.

1. Sign up for a [Notion](https://www.notion.so/) account, if you don't have one already.
2. Go to the [my integrations](https://www.notion.so/my-integrations) page and click on **New integration**.
3. Fill up the basic information like **Name**, **Logo** and click on **Submit**.
4. Now, click on **Distribution** tab on the sidebar. A text will appear which will ask you to make the integration public. Click on that toggle button. A form will appear below the text.
5. Now provide it the details such as requested. Under **Redirect URIs** field:
   - If you are running typeflowai locally, you can enter `http://localhost:3000/api/v1/integrations/notion/callback`.
   - Or, you can enter `https://<your-public-facing-url>/api/v1/integrations/notion/callback`
6. Once you've filled all the necessary details, click on **Submit**.
7. A screen will appear which will have **Client ID**, **Client secret** and **Authorization URL**. Copy them and set them as the environment variables in your TypeflowAI instance as:
   - `NOTION_OAUTH_CLIENT_ID` - OAuth Client ID
   - `NOTION_OAUTH_CLIENT_SECRET` - OAuth Client Secret

Voila! You have successfully enabled the Notion integration in your self-hosted TypeflowAI instance. Now you can follow the steps mentioned in the [TypeflowAI Cloud](#typeflowai-cloud) section to link a Notion database with TypeflowAI.

## Remove Integration with Notion Account

To remove the integration with Notion Account,

1. Visit the Integrations tab in your TypeflowAI Cloud dashboard.
2. Select "Manage" button in the Notion card.
3. Click on the "Connected with `<your-workspace-name-here`> Workspace" just before the "Link new Database" button.
4. It will now ask for a confirmation to remove the integration. Click on the "Delete" button to remove the integration. You can always come back and connect again with the same Notion Account.

<MdxImage
  src={DeleteConnection}
  alt="Delete Notion Integration with TypeflowAI"
  quality="100"
  className="max-w-full rounded-lg sm:max-w-3xl"
/>

{/* Still struggling or something not working as expected? [Join our Discord!](https://typeflowai.com/discord) and we'd be glad to assist you! */}
