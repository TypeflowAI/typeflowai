import { Callout } from "@/components/shared/Callout";
import { Fence } from "@/components/shared/Fence";
import MdxImage from "next/image";

import AirtableConnected from "./airtable-connected.png";
import ConnectWithAirtable from "./connect-with-airtable.png";
import DeleteIntegration from "./deleteIntegration.png";
import IntegrationTab from "./integrations-tab.png";
import LinkWithQuestions from "./link-with-questions.png";
import LinkWorkflowWithTable from "./link-workflow-with-table.png";
import ListLinkedWorkflows from "./list-linked-workflows.png";

export const metadata = {
  title: "Airtable Setup",
  description: "Instantly populate your airtable table with workflow data",
};

#### Integrations

# Airtable

The Airtable integration allows you to automatically send responses to an Airtable of your choice.

<Note>
  This feature is enabled by default in TypeflowAI Cloud but needs to be self-configured when running a
  self-hosted version of TypeflowAI.
</Note>

## TypeflowAI Cloud

1. Go to the Integrations tab in your [TypeflowAI Cloud dashboard](https://dashboard.typeflowai.com/) and click on the "Connect" button under Airtable integration.

<MdxImage
  src={IntegrationTab}
  alt="TypeflowAI Integrations Tab"
  quality="100"
  className="max-w-full rounded-lg sm:max-w-3xl"
/>

2. Now click on the "Connect with Airtable" button to authenticate yourself with Airtable.

<MdxImage
  src={ConnectWithAirtable}
  alt="Connect TypeflowAI with Airtable"
  quality="100"
  className="max-w-full rounded-lg sm:max-w-3xl"
/>

3. You will now be taken to a page where you need to add and grant access to the base you want to use for the integration.

<MdxImage
  src={ConnectWithAirtable}
  alt="Add and grant access to airtable base"
  quality="100"
  className="max-w-full rounded-lg sm:max-w-3xl"
/>

4. Once you add and grant access to your base, you will be taken back to TypeflowAI Cloud and see the connected status as below:

<MdxImage
  src={AirtableConnected}
  alt="TypeflowAI is now connected with Google"
  quality="100"
  className="max-w-full rounded-lg sm:max-w-3xl"
/>

<Note>

Before the next step, make sure that you have a TypeflowAI Workflow with at least one question and a Airtable base with atleast one table in the Airtable account you integrated.

</Note>

6. Now click on the "Link New Table" button to link a new Airtable with TypeflowAI and a modal will open up.

<MdxImage
  src={LinkWorkflowWithTable}
  alt="Link TypeflowAI with a Airtable"
  quality="100"
  className="max-w-full rounded-lg sm:max-w-3xl"
/>

7. Select the Base and table you want to link with TypeflowAI and the Workflow. On doing so, you will be asked with what questions' responses you want to feed in Airtable. Select the questions and click on the "Save" button.

<MdxImage
  src={LinkWithQuestions}
  alt="Select question to link with Airtable"
  quality="100"
  className="max-w-full rounded-lg sm:max-w-3xl"

/>

8. On submitting, the modal will close and you will see the linked table in the list of linked tables.

<MdxImage
  src={ListLinkedWorkflows}
  alt="List of linked tables"
  quality="100"
  className="max-w-full rounded-lg sm:max-w-3xl"
/>

Congratulations! You have successfully linked an Airtable with TypeflowAI. Now whenever a response is submitted for the linked Workflow, it will be automatically added to the linked Airtable.

{/* Still struggling or something not working as expected? [Join our Discord!](https://typeflowai.com/discord) and we'd be glad to assist you! */}

## Setup in self-hosted TypeflowAI

Enabling the Airtable Integration in a self-hosted environment requires creating an airtable account and changing the environment variables of your TypeflowAI instance.

1. Go to the [Airtable](https://airtable.com) and create a new account if you dont already have one.

2. Click on user icon on top left and open to Developer hub

3. Navigate to OAuth integrations and click on **Register an OAuth integrations**

4. Select a name for you integration and also add a redirect URL which will be YOUR_WEBAPP_URL/api/v1/integrations/airtable/callback

5. Now fill some basic details about your integrations and then go to scope section. You need to enable 5 scopes

   - data.records:read
   - data.records:write
   - schema.bases:read
   - schema.bases:write
   - user.email:read

6. Click on the "Save" button and you are done
7. Now just copy client id and redirect url for your integration and add it to typeflowai .env file

### By now, your environment variables should include the below ones:

- `AIRTABLE_CLIENT_ID`
- `AIRTABLE_REDIRECT_URL`

Voila! You have successfully enabled the Airtable integration in your self-hosted TypeflowAI instance. Now you can follow the steps mentioned in the [TypeflowAI Cloud](#typeflowai-cloud) section to link an Airtable with TypeflowAI.

## Remove Integration with Airtable

To remove the integration with Airtable,

1. Visit the Integrations tab in your TypeflowAI Cloud dashboard.
2. Select "Manage" button in the Airtable card.
3. Click on the "Connected with `<your-email-here`>" just before the "Link new Table" button.
4. It will now ask for a confirmation to remove the integration. Click on the "Delete" button to remove the integration. You can always come back and connect again with the same Airtable Account.

<MdxImage
  src={DeleteIntegration}
  alt="Delete Airtable Integration with TypeflowAI"
  quality="100"
  className="max-w-full rounded-lg sm:max-w-3xl"
/>

<Note>
  We do not store any other information of yours! We value Privacy more than you and rest assured you're safe
  with us!
</Note>

{/* Still struggling or something not working as expected? [Join our Discord!](https://typeflowai.com/discord) and we'd be glad to assist you! */}
